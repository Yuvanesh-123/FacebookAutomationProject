package facebook;

import io.github.bonigarcia.wdm.WebDriverManager;

import java.text.SimpleDateFormat;
import java.util.Date;

import org.bouncycastle.oer.Switch;
import org.openqa.selenium.WebDriver;
import org.openqa.selenium.chrome.ChromeDriver;

import com.aventstack.extentreports.ExtentReports;
import com.aventstack.extentreports.ExtentTest;
import com.aventstack.extentreports.Status;
import com.aventstack.extentreports.reporter.ExtentSparkReporter;

public class Helper {
	static WebDriver driver;
	static String currentTimeStamp;
	static ExtentReports report;

	public static void Webdrivers() {
		WebDriverManager.chromedriver().setup();
		driver = new ChromeDriver();

	}

	/*
	 * @param Not required
	 * 
	 * @return This method provide the driver Instance
	 */

	public static WebDriver getDriver() {
		if (driver == null) {
			Webdrivers();
		}
		return driver;
	}

	public static void initiateExtentReport() {
		Date date = new Date();
		SimpleDateFormat formattedTime = new SimpleDateFormat("dd-MM-yyyy_HH-mm-ss");
		currentTimeStamp = formattedTime.format(date);
		report = new ExtentReports();
		Status x[] = new Status[1];
		x[0] = Status.SKIP;

		ExtentSparkReporter allCasesRepot = new ExtentSparkReporter(
				"D:\\Eclipse\\DemoProjectScripts\\Reports" + currentTimeStamp + "AllCasesReport.html");
		ExtentSparkReporter passCasesRepot = new ExtentSparkReporter(
				"D:\\Eclipse\\DemoProjectScripts\\Reports" + currentTimeStamp + "PassCasesReport.html").filter()
				.statusFilter().as(new Status[] { Status.PASS }).apply();
		ExtentSparkReporter failCasesRepot = new ExtentSparkReporter(
				"D:\\Eclipse\\DemoProjectScripts\\Reports" + currentTimeStamp + "FailCasesReport.html").filter()
				.statusFilter().as(new Status[] { Status.FAIL }).apply();
		ExtentSparkReporter skipCasesRepot = new ExtentSparkReporter(
				"D:\\Eclipse\\DemoProjectScripts\\Reports" + currentTimeStamp + "SkipCasesReport.html").filter()
				.statusFilter().as(new Status[] { Status.SKIP }).apply();
		report.attachReporter(allCasesRepot, passCasesRepot, failCasesRepot, skipCasesRepot);

	}

	public static ExtentReports getReport() {
		if (report == null) {
			initiateExtentReport();

		}
		return report;
	}

	public enum Pages {
		Login, Dashboard
	}

	public static ExtentTest createTest(Pages pages, String testName) {
		ExtentReports report = getReport();
		ExtentTest test;

		switch (pages) {
		case Login:
			test = report.createTest(String.format("Login Page - %s", testName));
			test.assignCategory("Login Page");
			return test;

		case Dashboard:
			test = report.createTest(String.format("Dashboard - %s", testName));
			test.assignCategory("Dashboard");
			return test;

		}
		return null;

	}

}
